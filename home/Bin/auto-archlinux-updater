#!/usr/bin/env bash

[ $UID != 0 ] && echo "non-root user detected" && exit 

pgrep pacman 1> /dev/null && echo "pacman is already running" && exit 

packagesToUpdate=$(checkupdates | awk '{print $1}')

if [[ ! -z "$packagesToUpdate" ]] ; then
     notify-send "Updating $packagesToUpdate package(s)"
     while true ; do
       pacman -Syu --noconfirm
       if [ $? = '0' ] ; then
          break
       fi
     done
    notify-send "System updated successfully"
    else
    notify-send "There is nothing to do"
fi
